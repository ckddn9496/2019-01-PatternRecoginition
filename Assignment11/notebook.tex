
% Default to the notebook output style

    


% Inherit from the specified cell style.




    
\documentclass[11pt]{article}

    
    
    \usepackage[T1]{fontenc}
    % Nicer default font (+ math font) than Computer Modern for most use cases
    \usepackage{mathpazo}

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % We will generate all images so they have a width \maxwidth. This means
    % that they will get their normal width if they fit onto the page, but
    % are scaled down if they would overflow the margins.
    \makeatletter
    \def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth
    \else\Gin@nat@width\fi}
    \makeatother
    \let\Oldincludegraphics\includegraphics
    % Set max figure width to be 80% of text width, for now hardcoded.
    \renewcommand{\includegraphics}[1]{\Oldincludegraphics[width=.8\maxwidth]{#1}}
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \DeclareCaptionLabelFormat{nolabel}{}
    \captionsetup{labelformat=nolabel}

    \usepackage{adjustbox} % Used to constrain images to a maximum size 
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro
    \usepackage[mathletters]{ucs} % Extended unicode (utf-8) support
    \usepackage[utf8x]{inputenc} % Allow utf-8 characters in the tex document
    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics 
                         % to support a larger range 
    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
    

    
    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}
    
    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    
    
    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatability definitions
    \def\gt{>}
    \def\lt{<}
    % Document parameters
    \title{20146518\_Assignment11}
    
    
    

    % Pygments definitions
    
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\expandafter\def\csname PY@tok@w\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\expandafter\def\csname PY@tok@c\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.74,0.48,0.00}{##1}}}
\expandafter\def\csname PY@tok@k\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\expandafter\def\csname PY@tok@o\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ow\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@nb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@ne\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.82,0.25,0.23}{##1}}}
\expandafter\def\csname PY@tok@nv\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@no\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@nl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@ni\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.60,0.60,0.60}{##1}}}
\expandafter\def\csname PY@tok@na\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.49,0.56,0.16}{##1}}}
\expandafter\def\csname PY@tok@nt\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@s\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sd\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@si\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@se\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.13}{##1}}}
\expandafter\def\csname PY@tok@sr\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@ss\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sx\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@m\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@gh\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gu\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@gi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@gr\endcsname{\def\PY@tc##1{\textcolor[rgb]{1.00,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@ge\endcsname{\let\PY@it=\textit}
\expandafter\def\csname PY@tok@gs\endcsname{\let\PY@bf=\textbf}
\expandafter\def\csname PY@tok@gp\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@go\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.53,0.53}{##1}}}
\expandafter\def\csname PY@tok@gt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\expandafter\def\csname PY@tok@err\endcsname{\def\PY@bc##1{\setlength{\fboxsep}{0pt}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}
\expandafter\def\csname PY@tok@kc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kd\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kr\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@bp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@fm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@vc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vg\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sa\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@dl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s2\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s1\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@mb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@il\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mo\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ch\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cm\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cpf\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@c1\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cs\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % Exact colors from NB
    \definecolor{incolor}{rgb}{0.0, 0.0, 0.5}
    \definecolor{outcolor}{rgb}{0.545, 0.0, 0.0}



    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy 
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

    \begin{document}
    
    
    \maketitle
    
    

    
    Build a binary classifier for each digit against all the other digits at
MNIST dataset.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}81}]:} \PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
         \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
\end{Verbatim}


    load train and test datas from .csv files

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}82}]:} \PY{n}{file\PYZus{}data\PYZus{}train} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{mnist\PYZus{}train.csv}\PY{l+s+s2}{\PYZdq{}}
         \PY{n}{file\PYZus{}data\PYZus{}test}  \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{mnist\PYZus{}test.csv}\PY{l+s+s2}{\PYZdq{}}
         
         \PY{n}{h\PYZus{}data\PYZus{}train}    \PY{o}{=} \PY{n+nb}{open}\PY{p}{(}\PY{n}{file\PYZus{}data\PYZus{}train}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{r}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n}{h\PYZus{}data\PYZus{}test}     \PY{o}{=} \PY{n+nb}{open}\PY{p}{(}\PY{n}{file\PYZus{}data\PYZus{}test}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{r}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         
         \PY{n}{data\PYZus{}train}      \PY{o}{=} \PY{n}{h\PYZus{}data\PYZus{}train}\PY{o}{.}\PY{n}{readlines}\PY{p}{(}\PY{p}{)}
         \PY{n}{data\PYZus{}test}       \PY{o}{=} \PY{n}{h\PYZus{}data\PYZus{}test}\PY{o}{.}\PY{n}{readlines}\PY{p}{(}\PY{p}{)}
         
         \PY{n}{h\PYZus{}data\PYZus{}train}\PY{o}{.}\PY{n}{close}\PY{p}{(}\PY{p}{)}
         \PY{n}{h\PYZus{}data\PYZus{}test}\PY{o}{.}\PY{n}{close}\PY{p}{(}\PY{p}{)}
         
         \PY{n}{size\PYZus{}row}    \PY{o}{=} \PY{l+m+mi}{28}    \PY{c+c1}{\PYZsh{} height of the image}
         \PY{n}{size\PYZus{}col}    \PY{o}{=} \PY{l+m+mi}{28}    \PY{c+c1}{\PYZsh{} width of the image}
         
         \PY{n}{num\PYZus{}train}   \PY{o}{=} \PY{n+nb}{len}\PY{p}{(}\PY{n}{data\PYZus{}train}\PY{p}{)}   \PY{c+c1}{\PYZsh{} number of training images}
         \PY{n}{num\PYZus{}test}    \PY{o}{=} \PY{n+nb}{len}\PY{p}{(}\PY{n}{data\PYZus{}test}\PY{p}{)}    \PY{c+c1}{\PYZsh{} number of testing images}
         
         \PY{c+c1}{\PYZsh{}}
         \PY{c+c1}{\PYZsh{} normalize the values of the input data to be [0, 1]}
         \PY{c+c1}{\PYZsh{}}
         \PY{k}{def} \PY{n+nf}{normalize}\PY{p}{(}\PY{n}{data}\PY{p}{)}\PY{p}{:}
         
             \PY{n}{data\PYZus{}normalized} \PY{o}{=} \PY{p}{(}\PY{n}{data} \PY{o}{\PYZhy{}} \PY{n+nb}{min}\PY{p}{(}\PY{n}{data}\PY{p}{)}\PY{p}{)} \PY{o}{/} \PY{p}{(}\PY{n+nb}{max}\PY{p}{(}\PY{n}{data}\PY{p}{)} \PY{o}{\PYZhy{}} \PY{n+nb}{min}\PY{p}{(}\PY{n}{data}\PY{p}{)}\PY{p}{)}
         
             \PY{k}{return}\PY{p}{(}\PY{n}{data\PYZus{}normalized}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}}
         \PY{c+c1}{\PYZsh{} example of distance function between two vectors x and y}
         \PY{c+c1}{\PYZsh{}}
         \PY{k}{def} \PY{n+nf}{distance}\PY{p}{(}\PY{n}{x}\PY{p}{,} \PY{n}{y}\PY{p}{)}\PY{p}{:}
         
             \PY{n}{d} \PY{o}{=} \PY{p}{(}\PY{n}{x} \PY{o}{\PYZhy{}} \PY{n}{y}\PY{p}{)} \PY{o}{*}\PY{o}{*} \PY{l+m+mi}{2}
             \PY{n}{s} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{n}{d}\PY{p}{)}
             \PY{c+c1}{\PYZsh{} r = np.sqrt(s)}
         
             \PY{k}{return}\PY{p}{(}\PY{n}{s}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}}
         \PY{c+c1}{\PYZsh{} make a matrix each column of which represents an images in a vector form }
         \PY{c+c1}{\PYZsh{}}
         \PY{n}{list\PYZus{}image\PYZus{}train}    \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{empty}\PY{p}{(}\PY{p}{(}\PY{n}{size\PYZus{}row} \PY{o}{*} \PY{n}{size\PYZus{}col}\PY{p}{,} \PY{n}{num\PYZus{}train}\PY{p}{)}\PY{p}{,} \PY{n}{dtype}\PY{o}{=}\PY{n+nb}{float}\PY{p}{)}
         \PY{n}{list\PYZus{}label\PYZus{}train}    \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{empty}\PY{p}{(}\PY{n}{num\PYZus{}train}\PY{p}{,} \PY{n}{dtype}\PY{o}{=}\PY{n+nb}{int}\PY{p}{)}
         
         \PY{n}{list\PYZus{}image\PYZus{}test}     \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{empty}\PY{p}{(}\PY{p}{(}\PY{n}{size\PYZus{}row} \PY{o}{*} \PY{n}{size\PYZus{}col}\PY{p}{,} \PY{n}{num\PYZus{}test}\PY{p}{)}\PY{p}{,} \PY{n}{dtype}\PY{o}{=}\PY{n+nb}{float}\PY{p}{)}
         \PY{n}{list\PYZus{}label\PYZus{}test}     \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{empty}\PY{p}{(}\PY{n}{num\PYZus{}test}\PY{p}{,} \PY{n}{dtype}\PY{o}{=}\PY{n+nb}{int}\PY{p}{)}
         
         \PY{n}{count} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{c+c1}{\PYZsh{} read train data}
         \PY{k}{for} \PY{n}{line} \PY{o+ow}{in} \PY{n}{data\PYZus{}train}\PY{p}{:}
         
             \PY{n}{line\PYZus{}data}   \PY{o}{=} \PY{n}{line}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{,}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{n}{label}       \PY{o}{=} \PY{n}{line\PYZus{}data}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
             \PY{n}{im\PYZus{}vector}   \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{asfarray}\PY{p}{(}\PY{n}{line\PYZus{}data}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{:}\PY{p}{]}\PY{p}{)} \PY{c+c1}{\PYZsh{}float형으로 변형}
             \PY{n}{im\PYZus{}vector}   \PY{o}{=} \PY{n}{normalize}\PY{p}{(}\PY{n}{im\PYZus{}vector}\PY{p}{)}
         
             \PY{n}{list\PYZus{}label\PYZus{}train}\PY{p}{[}\PY{n}{count}\PY{p}{]}     \PY{o}{=} \PY{n}{label}
             \PY{n}{list\PYZus{}image\PYZus{}train}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{n}{count}\PY{p}{]}  \PY{o}{=} \PY{n}{im\PYZus{}vector}    
            
             \PY{n}{count} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
         
         \PY{n}{count} \PY{o}{=} \PY{l+m+mi}{0}
         \PY{c+c1}{\PYZsh{} read test data}
         \PY{k}{for} \PY{n}{line} \PY{o+ow}{in} \PY{n}{data\PYZus{}test}\PY{p}{:}
             \PY{n}{line\PYZus{}data}   \PY{o}{=} \PY{n}{line}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{,}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{n}{label}       \PY{o}{=} \PY{n}{line\PYZus{}data}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
             \PY{n}{im\PYZus{}vector}   \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{asfarray}\PY{p}{(}\PY{n}{line\PYZus{}data}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{:}\PY{p}{]}\PY{p}{)}
             \PY{n}{im\PYZus{}vector}   \PY{o}{=} \PY{n}{normalize}\PY{p}{(}\PY{n}{im\PYZus{}vector}\PY{p}{)}
         
             \PY{n}{list\PYZus{}label\PYZus{}test}\PY{p}{[}\PY{n}{count}\PY{p}{]}      \PY{o}{=} \PY{n}{label}
             \PY{n}{list\PYZus{}image\PYZus{}test}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{n}{count}\PY{p}{]}   \PY{o}{=} \PY{n}{im\PYZus{}vector}    
         
             \PY{n}{count} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}83}]:} \PY{n+nb}{print}\PY{p}{(}\PY{n}{list\PYZus{}label\PYZus{}train}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{list\PYZus{}image\PYZus{}train}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{list\PYZus{}label\PYZus{}test}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{list\PYZus{}image\PYZus{}test}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
(60000,)
(784, 60000)
(10000,)
(784, 10000)

    \end{Verbatim}

    use random vector and one-vector for accuracy

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}84}]:} \PY{k}{def} \PY{n+nf}{multi\PYZus{}label\PYZus{}classifier\PYZus{}with\PYZus{}randomvectors}\PY{p}{(}\PY{n}{p}\PY{p}{)}\PY{p}{:}
             \PY{c+c1}{\PYZsh{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
             \PY{c+c1}{\PYZsh{} finding out model parameters(theta) for each digit}
             \PY{n}{list\PYZus{}label\PYZus{}train\PYZus{}} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{empty}\PY{p}{(}\PY{n}{num\PYZus{}train}\PY{p}{,} \PY{n}{dtype}\PY{o}{=}\PY{n+nb}{int}\PY{p}{)}
             \PY{c+c1}{\PYZsh{} read train data and set 1 or \PYZhy{}1 wher label is not correct}
            
             \PY{n}{R}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{empty}\PY{p}{(}\PY{p}{(}\PY{n}{p}\PY{p}{,}\PY{n}{size\PYZus{}row} \PY{o}{*} \PY{n}{size\PYZus{}col}\PY{p}{)}\PY{p}{,}\PY{n}{dtype}\PY{o}{=}\PY{n+nb}{float}\PY{p}{)}
             \PY{n}{count}\PY{o}{=}\PY{l+m+mi}{0}
             \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{p}\PY{p}{)}\PY{p}{:} \PY{c+c1}{\PYZsh{} make random image and set on matrix R}
                 \PY{n}{r}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{random}\PY{o}{.}\PY{n}{normal}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{n}{size\PYZus{}row} \PY{o}{*} \PY{n}{size\PYZus{}col}\PY{p}{)}
                 \PY{n}{R}\PY{p}{[}\PY{n}{count}\PY{p}{,}\PY{p}{:}\PY{p}{]}  \PY{o}{=} \PY{n}{r}    
                 \PY{n}{count} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
                 
             \PY{n}{A\PYZus{}temp}\PY{o}{=}\PY{p}{(}\PY{n}{R}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{list\PYZus{}image\PYZus{}train}\PY{p}{)}\PY{p}{)}\PY{o}{.}\PY{n}{T}
             \PY{n}{A\PYZus{}one}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{ones}\PY{p}{(}\PY{p}{(}\PY{n}{num\PYZus{}train}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,}\PY{n}{dtype}\PY{o}{=}\PY{n+nb}{float}\PY{p}{)} \PY{c+c1}{\PYZsh{} for improve accuracy}
             \PY{n}{A\PYZus{}r}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{hstack}\PY{p}{(}\PY{p}{[}\PY{n}{A\PYZus{}one}\PY{p}{,} \PY{n}{A\PYZus{}temp}\PY{p}{]}\PY{p}{)}           \PY{c+c1}{\PYZsh{} add 1\PYZhy{}vector}
             
             
             \PY{c+c1}{\PYZsh{} compute theta\PYZus{}d\PYZus{}r}
             \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{num\PYZus{}train}\PY{p}{)}\PY{p}{:}
                 \PY{k}{if} \PY{p}{(}\PY{n}{list\PYZus{}label\PYZus{}train}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{o}{==}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{:}
                     \PY{n}{list\PYZus{}label\PYZus{}train\PYZus{}}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{o}{=}\PY{l+m+mi}{1}
                 \PY{k}{else}\PY{p}{:}
                     \PY{n}{list\PYZus{}label\PYZus{}train\PYZus{}}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}
             \PY{n}{theta0\PYZus{}r}\PY{o}{=}\PY{p}{(}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{linalg}\PY{o}{.}\PY{n}{pinv}\PY{p}{(}\PY{p}{(}\PY{n}{A\PYZus{}r}\PY{o}{.}\PY{n}{T}\PY{p}{)}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{A\PYZus{}r}\PY{p}{)}\PY{p}{)}\PY{p}{)}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{A\PYZus{}r}\PY{o}{.}\PY{n}{T}\PY{p}{)}\PY{p}{)}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{list\PYZus{}label\PYZus{}train\PYZus{}}\PY{p}{)}
             \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{num\PYZus{}train}\PY{p}{)}\PY{p}{:}
                 \PY{k}{if} \PY{p}{(}\PY{n}{list\PYZus{}label\PYZus{}train}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{o}{==}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{:}
                     \PY{n}{list\PYZus{}label\PYZus{}train\PYZus{}}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{o}{=}\PY{l+m+mi}{1}
                 \PY{k}{else}\PY{p}{:}
                     \PY{n}{list\PYZus{}label\PYZus{}train\PYZus{}}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}
             \PY{n}{theta1\PYZus{}r}\PY{o}{=}\PY{p}{(}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{linalg}\PY{o}{.}\PY{n}{pinv}\PY{p}{(}\PY{p}{(}\PY{n}{A\PYZus{}r}\PY{o}{.}\PY{n}{T}\PY{p}{)}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{A\PYZus{}r}\PY{p}{)}\PY{p}{)}\PY{p}{)}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{A\PYZus{}r}\PY{o}{.}\PY{n}{T}\PY{p}{)}\PY{p}{)}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{list\PYZus{}label\PYZus{}train\PYZus{}}\PY{p}{)}
             
             \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{num\PYZus{}train}\PY{p}{)}\PY{p}{:}
                 \PY{k}{if} \PY{p}{(}\PY{n}{list\PYZus{}label\PYZus{}train}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{o}{==}\PY{l+m+mi}{2}\PY{p}{)}\PY{p}{:}
                     \PY{n}{list\PYZus{}label\PYZus{}train\PYZus{}}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{o}{=}\PY{l+m+mi}{1}
                 \PY{k}{else}\PY{p}{:}
                     \PY{n}{list\PYZus{}label\PYZus{}train\PYZus{}}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}
             \PY{n}{theta2\PYZus{}r}\PY{o}{=}\PY{p}{(}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{linalg}\PY{o}{.}\PY{n}{pinv}\PY{p}{(}\PY{p}{(}\PY{n}{A\PYZus{}r}\PY{o}{.}\PY{n}{T}\PY{p}{)}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{A\PYZus{}r}\PY{p}{)}\PY{p}{)}\PY{p}{)}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{A\PYZus{}r}\PY{o}{.}\PY{n}{T}\PY{p}{)}\PY{p}{)}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{list\PYZus{}label\PYZus{}train\PYZus{}}\PY{p}{)}
             
             \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{num\PYZus{}train}\PY{p}{)}\PY{p}{:}
                 \PY{k}{if} \PY{p}{(}\PY{n}{list\PYZus{}label\PYZus{}train}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{o}{==}\PY{l+m+mi}{3}\PY{p}{)}\PY{p}{:}
                     \PY{n}{list\PYZus{}label\PYZus{}train\PYZus{}}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{o}{=}\PY{l+m+mi}{1}
                 \PY{k}{else}\PY{p}{:}
                     \PY{n}{list\PYZus{}label\PYZus{}train\PYZus{}}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}
             \PY{n}{theta3\PYZus{}r}\PY{o}{=}\PY{p}{(}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{linalg}\PY{o}{.}\PY{n}{pinv}\PY{p}{(}\PY{p}{(}\PY{n}{A\PYZus{}r}\PY{o}{.}\PY{n}{T}\PY{p}{)}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{A\PYZus{}r}\PY{p}{)}\PY{p}{)}\PY{p}{)}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{A\PYZus{}r}\PY{o}{.}\PY{n}{T}\PY{p}{)}\PY{p}{)}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{list\PYZus{}label\PYZus{}train\PYZus{}}\PY{p}{)}
             
             \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{num\PYZus{}train}\PY{p}{)}\PY{p}{:}
                 \PY{k}{if} \PY{p}{(}\PY{n}{list\PYZus{}label\PYZus{}train}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{o}{==}\PY{l+m+mi}{4}\PY{p}{)}\PY{p}{:}
                     \PY{n}{list\PYZus{}label\PYZus{}train\PYZus{}}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{o}{=}\PY{l+m+mi}{1}
                 \PY{k}{else}\PY{p}{:}
                     \PY{n}{list\PYZus{}label\PYZus{}train\PYZus{}}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}
             \PY{n}{theta4\PYZus{}r}\PY{o}{=}\PY{p}{(}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{linalg}\PY{o}{.}\PY{n}{pinv}\PY{p}{(}\PY{p}{(}\PY{n}{A\PYZus{}r}\PY{o}{.}\PY{n}{T}\PY{p}{)}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{A\PYZus{}r}\PY{p}{)}\PY{p}{)}\PY{p}{)}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{A\PYZus{}r}\PY{o}{.}\PY{n}{T}\PY{p}{)}\PY{p}{)}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{list\PYZus{}label\PYZus{}train\PYZus{}}\PY{p}{)}
             
             \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{num\PYZus{}train}\PY{p}{)}\PY{p}{:}
                 \PY{k}{if} \PY{p}{(}\PY{n}{list\PYZus{}label\PYZus{}train}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{o}{==}\PY{l+m+mi}{5}\PY{p}{)}\PY{p}{:}
                     \PY{n}{list\PYZus{}label\PYZus{}train\PYZus{}}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{o}{=}\PY{l+m+mi}{1}
                 \PY{k}{else}\PY{p}{:}
                     \PY{n}{list\PYZus{}label\PYZus{}train\PYZus{}}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}
             \PY{n}{theta5\PYZus{}r}\PY{o}{=}\PY{p}{(}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{linalg}\PY{o}{.}\PY{n}{pinv}\PY{p}{(}\PY{p}{(}\PY{n}{A\PYZus{}r}\PY{o}{.}\PY{n}{T}\PY{p}{)}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{A\PYZus{}r}\PY{p}{)}\PY{p}{)}\PY{p}{)}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{A\PYZus{}r}\PY{o}{.}\PY{n}{T}\PY{p}{)}\PY{p}{)}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{list\PYZus{}label\PYZus{}train\PYZus{}}\PY{p}{)}
             
             \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{num\PYZus{}train}\PY{p}{)}\PY{p}{:}
                 \PY{k}{if} \PY{p}{(}\PY{n}{list\PYZus{}label\PYZus{}train}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{o}{==}\PY{l+m+mi}{6}\PY{p}{)}\PY{p}{:}
                     \PY{n}{list\PYZus{}label\PYZus{}train\PYZus{}}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{o}{=}\PY{l+m+mi}{1}
                 \PY{k}{else}\PY{p}{:}
                     \PY{n}{list\PYZus{}label\PYZus{}train\PYZus{}}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}
             \PY{n}{theta6\PYZus{}r}\PY{o}{=}\PY{p}{(}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{linalg}\PY{o}{.}\PY{n}{pinv}\PY{p}{(}\PY{p}{(}\PY{n}{A\PYZus{}r}\PY{o}{.}\PY{n}{T}\PY{p}{)}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{A\PYZus{}r}\PY{p}{)}\PY{p}{)}\PY{p}{)}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{A\PYZus{}r}\PY{o}{.}\PY{n}{T}\PY{p}{)}\PY{p}{)}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{list\PYZus{}label\PYZus{}train\PYZus{}}\PY{p}{)}
             
             \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{num\PYZus{}train}\PY{p}{)}\PY{p}{:}
                 \PY{k}{if} \PY{p}{(}\PY{n}{list\PYZus{}label\PYZus{}train}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{o}{==}\PY{l+m+mi}{7}\PY{p}{)}\PY{p}{:}
                     \PY{n}{list\PYZus{}label\PYZus{}train\PYZus{}}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{o}{=}\PY{l+m+mi}{1}
                 \PY{k}{else}\PY{p}{:}
                     \PY{n}{list\PYZus{}label\PYZus{}train\PYZus{}}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}
             \PY{n}{theta7\PYZus{}r}\PY{o}{=}\PY{p}{(}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{linalg}\PY{o}{.}\PY{n}{pinv}\PY{p}{(}\PY{p}{(}\PY{n}{A\PYZus{}r}\PY{o}{.}\PY{n}{T}\PY{p}{)}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{A\PYZus{}r}\PY{p}{)}\PY{p}{)}\PY{p}{)}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{A\PYZus{}r}\PY{o}{.}\PY{n}{T}\PY{p}{)}\PY{p}{)}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{list\PYZus{}label\PYZus{}train\PYZus{}}\PY{p}{)}
             
             \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{num\PYZus{}train}\PY{p}{)}\PY{p}{:}
                 \PY{k}{if} \PY{p}{(}\PY{n}{list\PYZus{}label\PYZus{}train}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{o}{==}\PY{l+m+mi}{8}\PY{p}{)}\PY{p}{:}
                     \PY{n}{list\PYZus{}label\PYZus{}train\PYZus{}}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{o}{=}\PY{l+m+mi}{1}
                 \PY{k}{else}\PY{p}{:}
                     \PY{n}{list\PYZus{}label\PYZus{}train\PYZus{}}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}
             \PY{n}{theta8\PYZus{}r}\PY{o}{=}\PY{p}{(}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{linalg}\PY{o}{.}\PY{n}{pinv}\PY{p}{(}\PY{p}{(}\PY{n}{A\PYZus{}r}\PY{o}{.}\PY{n}{T}\PY{p}{)}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{A\PYZus{}r}\PY{p}{)}\PY{p}{)}\PY{p}{)}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{A\PYZus{}r}\PY{o}{.}\PY{n}{T}\PY{p}{)}\PY{p}{)}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{list\PYZus{}label\PYZus{}train\PYZus{}}\PY{p}{)}
             \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{num\PYZus{}train}\PY{p}{)}\PY{p}{:}
                 \PY{k}{if} \PY{p}{(}\PY{n}{list\PYZus{}label\PYZus{}train}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{o}{==}\PY{l+m+mi}{9}\PY{p}{)}\PY{p}{:}
                     \PY{n}{list\PYZus{}label\PYZus{}train\PYZus{}}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{o}{=}\PY{l+m+mi}{1}
                 \PY{k}{else}\PY{p}{:}
                     \PY{n}{list\PYZus{}label\PYZus{}train\PYZus{}}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}
             \PY{n}{theta9\PYZus{}r}\PY{o}{=}\PY{p}{(}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{linalg}\PY{o}{.}\PY{n}{pinv}\PY{p}{(}\PY{p}{(}\PY{n}{A\PYZus{}r}\PY{o}{.}\PY{n}{T}\PY{p}{)}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{A\PYZus{}r}\PY{p}{)}\PY{p}{)}\PY{p}{)}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{A\PYZus{}r}\PY{o}{.}\PY{n}{T}\PY{p}{)}\PY{p}{)}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{list\PYZus{}label\PYZus{}train\PYZus{}}\PY{p}{)}
             
             \PY{c+c1}{\PYZsh{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
             
             \PY{c+c1}{\PYZsh{}\PYZhy{}\PYZhy{}\PYZhy{}this section is classifying the digits in train set \PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
             \PY{n}{y\PYZus{}train}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{empty}\PY{p}{(}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{,}\PY{n}{num\PYZus{}train}\PY{p}{)}\PY{p}{,}\PY{n}{dtype}\PY{o}{=}\PY{n+nb}{float}\PY{p}{)} \PY{c+c1}{\PYZsh{} make container}
             \PY{n}{ftrain\PYZus{}temp}\PY{o}{=}\PY{p}{(}\PY{n}{R}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{list\PYZus{}image\PYZus{}train}\PY{p}{)}\PY{p}{)}\PY{o}{.}\PY{n}{T}
             \PY{n}{A\PYZus{}one}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{ones}\PY{p}{(}\PY{p}{(}\PY{n}{num\PYZus{}train}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,}\PY{n}{dtype}\PY{o}{=}\PY{n+nb}{float}\PY{p}{)}
             \PY{n}{ftrain}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{hstack}\PY{p}{(}\PY{p}{[}\PY{n}{A\PYZus{}one}\PY{p}{,}\PY{n}{ftrain\PYZus{}temp}\PY{p}{]}\PY{p}{)} \PY{c+c1}{\PYZsh{} same task with train set for accuracy}
             \PY{n}{y\PYZus{}train}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{=}\PY{n}{ftrain}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{theta0\PYZus{}r}\PY{p}{)}
             \PY{n}{y\PYZus{}train}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{=}\PY{n}{ftrain}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{theta1\PYZus{}r}\PY{p}{)}
             \PY{n}{y\PYZus{}train}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{=}\PY{n}{ftrain}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{theta2\PYZus{}r}\PY{p}{)}
             \PY{n}{y\PYZus{}train}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{=}\PY{n}{ftrain}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{theta3\PYZus{}r}\PY{p}{)}
             \PY{n}{y\PYZus{}train}\PY{p}{[}\PY{l+m+mi}{4}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{=}\PY{n}{ftrain}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{theta4\PYZus{}r}\PY{p}{)}
             \PY{n}{y\PYZus{}train}\PY{p}{[}\PY{l+m+mi}{5}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{=}\PY{n}{ftrain}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{theta5\PYZus{}r}\PY{p}{)}
             \PY{n}{y\PYZus{}train}\PY{p}{[}\PY{l+m+mi}{6}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{=}\PY{n}{ftrain}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{theta6\PYZus{}r}\PY{p}{)}
             \PY{n}{y\PYZus{}train}\PY{p}{[}\PY{l+m+mi}{7}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{=}\PY{n}{ftrain}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{theta7\PYZus{}r}\PY{p}{)}
             \PY{n}{y\PYZus{}train}\PY{p}{[}\PY{l+m+mi}{8}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{=}\PY{n}{ftrain}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{theta8\PYZus{}r}\PY{p}{)}
             \PY{n}{y\PYZus{}train}\PY{p}{[}\PY{l+m+mi}{9}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{=}\PY{n}{ftrain}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{theta9\PYZus{}r}\PY{p}{)}
             
             \PY{n}{label\PYZus{}about\PYZus{}train}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{empty}\PY{p}{(}\PY{n}{num\PYZus{}train}\PY{p}{,}\PY{n}{dtype}\PY{o}{=}\PY{n+nb}{int}\PY{p}{)}
             \PY{c+c1}{\PYZsh{} find max prediction value\PYZsq{}s label and save into label\PYZus{}about\PYZus{}train}
             \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{num\PYZus{}train}\PY{p}{)}\PY{p}{:}
                 \PY{n}{max\PYZus{}}\PY{o}{=}\PY{n}{y\PYZus{}train}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{n}{i}\PY{p}{]}
                 \PY{n}{label\PYZus{}about\PYZus{}train}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{o}{=}\PY{l+m+mi}{0}
                 \PY{k}{for} \PY{n}{j} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{:}
                     \PY{k}{if}\PY{p}{(}\PY{n}{y\PYZus{}train}\PY{p}{[}\PY{n}{j}\PY{p}{,}\PY{n}{i}\PY{p}{]}\PY{o}{\PYZgt{}}\PY{n}{max\PYZus{}}\PY{p}{)}\PY{p}{:}
                         \PY{n}{label\PYZus{}about\PYZus{}train}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{o}{=}\PY{n}{j}
                         \PY{n}{max\PYZus{}}\PY{o}{=}\PY{n}{y\PYZus{}train}\PY{p}{[}\PY{n}{j}\PY{p}{,}\PY{n}{i}\PY{p}{]}
                         
             \PY{c+c1}{\PYZsh{} generate confusion train container}
             \PY{n}{confusion\PYZus{}train}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{,}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{)}
             
             \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{num\PYZus{}train}\PY{p}{)}\PY{p}{:}
                 \PY{c+c1}{\PYZsh{} confusion\PYZus{}train[f][f\PYZca{}] =\PYZgt{} f: label, f\PYZca{}: predict}
                 \PY{n}{confusion\PYZus{}train}\PY{p}{[}\PY{n}{list\PYZus{}label\PYZus{}train}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{,}\PY{n}{label\PYZus{}about\PYZus{}train}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{]}\PY{o}{+}\PY{o}{=}\PY{l+m+mi}{1}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{when p=}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{p}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{about train set confusion matrix}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{:}
                 \PY{n+nb}{print}\PY{p}{(}\PY{p}{)}
                 \PY{k}{for} \PY{n}{j} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{:}
                     \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{   }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{confusion\PYZus{}train}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{[}\PY{n}{j}\PY{p}{]}\PY{p}{,}\PY{n}{end}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{n}{c}\PY{o}{=}\PY{l+m+mi}{0}
             \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{:}
                 \PY{n}{c}\PY{o}{+}\PY{o}{=}\PY{n}{confusion\PYZus{}train}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{[}\PY{n}{i}\PY{p}{]}
             \PY{n}{accuracy} \PY{o}{=} \PY{n}{c}\PY{o}{/}\PY{n}{num\PYZus{}train}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{true positive rate about train set: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{accuracy}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{error rate about train set: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+m+mi}{1}\PY{o}{\PYZhy{}}\PY{n}{accuracy}\PY{p}{)}
             
             \PY{c+c1}{\PYZsh{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
             
             \PY{c+c1}{\PYZsh{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{} same in task set \PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
             \PY{n}{y\PYZus{}test}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{empty}\PY{p}{(}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{,}\PY{n}{num\PYZus{}test}\PY{p}{)}\PY{p}{,}\PY{n}{dtype}\PY{o}{=}\PY{n+nb}{float}\PY{p}{)}
             \PY{n}{ftest\PYZus{}temp}\PY{o}{=}\PY{p}{(}\PY{n}{R}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{list\PYZus{}image\PYZus{}test}\PY{p}{)}\PY{p}{)}\PY{o}{.}\PY{n}{T}
             \PY{n}{A\PYZus{}one}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{ones}\PY{p}{(}\PY{p}{(}\PY{n}{num\PYZus{}test}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,}\PY{n}{dtype}\PY{o}{=}\PY{n+nb}{float}\PY{p}{)}
             \PY{n}{ftest}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{hstack}\PY{p}{(}\PY{p}{[}\PY{n}{A\PYZus{}one}\PY{p}{,}\PY{n}{ftest\PYZus{}temp}\PY{p}{]}\PY{p}{)}
             \PY{n}{y\PYZus{}test}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{=}\PY{n}{ftest}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{theta0\PYZus{}r}\PY{p}{)}
             \PY{n}{y\PYZus{}test}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{=}\PY{n}{ftest}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{theta1\PYZus{}r}\PY{p}{)}
             \PY{n}{y\PYZus{}test}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{=}\PY{n}{ftest}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{theta2\PYZus{}r}\PY{p}{)}
             \PY{n}{y\PYZus{}test}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{=}\PY{n}{ftest}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{theta3\PYZus{}r}\PY{p}{)}
             \PY{n}{y\PYZus{}test}\PY{p}{[}\PY{l+m+mi}{4}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{=}\PY{n}{ftest}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{theta4\PYZus{}r}\PY{p}{)}
             \PY{n}{y\PYZus{}test}\PY{p}{[}\PY{l+m+mi}{5}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{=}\PY{n}{ftest}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{theta5\PYZus{}r}\PY{p}{)}
             \PY{n}{y\PYZus{}test}\PY{p}{[}\PY{l+m+mi}{6}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{=}\PY{n}{ftest}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{theta6\PYZus{}r}\PY{p}{)}
             \PY{n}{y\PYZus{}test}\PY{p}{[}\PY{l+m+mi}{7}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{=}\PY{n}{ftest}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{theta7\PYZus{}r}\PY{p}{)}
             \PY{n}{y\PYZus{}test}\PY{p}{[}\PY{l+m+mi}{8}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{=}\PY{n}{ftest}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{theta8\PYZus{}r}\PY{p}{)}
             \PY{n}{y\PYZus{}test}\PY{p}{[}\PY{l+m+mi}{9}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{=}\PY{n}{ftest}\PY{o}{.}\PY{n}{dot}\PY{p}{(}\PY{n}{theta9\PYZus{}r}\PY{p}{)}
             \PY{n}{label\PYZus{}about\PYZus{}test}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{empty}\PY{p}{(}\PY{n}{num\PYZus{}test}\PY{p}{,}\PY{n}{dtype}\PY{o}{=}\PY{n+nb}{int}\PY{p}{)}
             \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{num\PYZus{}test}\PY{p}{)}\PY{p}{:}
                 \PY{n}{max\PYZus{}}\PY{o}{=}\PY{n}{y\PYZus{}test}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{n}{i}\PY{p}{]}
                 \PY{n}{label\PYZus{}about\PYZus{}test}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{o}{=}\PY{l+m+mi}{0}
                 \PY{k}{for} \PY{n}{j} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{:}
                     \PY{k}{if}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{[}\PY{n}{j}\PY{p}{,}\PY{n}{i}\PY{p}{]}\PY{o}{\PYZgt{}}\PY{n}{max\PYZus{}}\PY{p}{)}\PY{p}{:}
                         \PY{n}{label\PYZus{}about\PYZus{}test}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{o}{=}\PY{n}{j}
                         \PY{n}{max\PYZus{}}\PY{o}{=}\PY{n}{y\PYZus{}test}\PY{p}{[}\PY{n}{j}\PY{p}{,}\PY{n}{i}\PY{p}{]}
             \PY{n}{confusion\PYZus{}test}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{,}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{)}
             \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{num\PYZus{}test}\PY{p}{)}\PY{p}{:}
                 \PY{n}{confusion\PYZus{}test}\PY{p}{[}\PY{n}{list\PYZus{}label\PYZus{}test}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{,}\PY{n}{label\PYZus{}about\PYZus{}test}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{]}\PY{o}{+}\PY{o}{=}\PY{l+m+mi}{1}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{about test set confusion matrix}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{:}
                 \PY{n+nb}{print}\PY{p}{(}\PY{p}{)}
                 \PY{k}{for} \PY{n}{j} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{:}
                     \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{   }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{confusion\PYZus{}test}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{[}\PY{n}{j}\PY{p}{]}\PY{p}{,}\PY{n}{end}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{n}{c}\PY{o}{=}\PY{l+m+mi}{0}
             \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{:}
                 \PY{n}{c}\PY{o}{+}\PY{o}{=}\PY{n}{confusion\PYZus{}test}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{[}\PY{n}{i}\PY{p}{]}
             \PY{n}{accuracy} \PY{o}{=} \PY{n}{c}\PY{o}{/}\PY{n}{num\PYZus{}test}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{true positive rate test set: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{n}{c}\PY{o}{/}\PY{n}{num\PYZus{}test}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{error rate about train set: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+m+mi}{1}\PY{o}{\PYZhy{}}\PY{n}{accuracy}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}\PYZhy{}}
             \PY{k}{return}
\end{Verbatim}


    print confused matrix for train and test set with true positive, error
rates

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}85}]:} \PY{n}{multi\PYZus{}label\PYZus{}classifier\PYZus{}with\PYZus{}randomvectors}\PY{p}{(}\PY{l+m+mi}{2}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{5}\PY{p}{)}
         \PY{n}{multi\PYZus{}label\PYZus{}classifier\PYZus{}with\PYZus{}randomvectors}\PY{p}{(}\PY{l+m+mi}{2}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{6}\PY{p}{)}
         \PY{n}{multi\PYZus{}label\PYZus{}classifier\PYZus{}with\PYZus{}randomvectors}\PY{p}{(}\PY{l+m+mi}{2}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{7}\PY{p}{)}
         \PY{n}{multi\PYZus{}label\PYZus{}classifier\PYZus{}with\PYZus{}randomvectors}\PY{p}{(}\PY{l+m+mi}{2}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{8}\PY{p}{)}
         \PY{n}{multi\PYZus{}label\PYZus{}classifier\PYZus{}with\PYZus{}randomvectors}\PY{p}{(}\PY{l+m+mi}{2}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{9}\PY{p}{)}
         \PY{n}{multi\PYZus{}label\PYZus{}classifier\PYZus{}with\PYZus{}randomvectors}\PY{p}{(}\PY{l+m+mi}{2}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{10}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]



---------------------------------------
when p= 32

about train set confusion matrix

    5284.0    62.0    74.0    59.0    45.0    89.0    151.0    123.0    23.0    13.0
    3.0    6488.0    51.0    37.0    52.0    8.0    32.0    19.0    26.0    26.0
    137.0    547.0    3853.0    218.0    256.0    23.0    364.0    339.0    198.0    23.0
    169.0    338.0    224.0    4438.0    77.0    185.0    178.0    194.0    192.0    136.0
    54.0    281.0    72.0    121.0    4292.0    89.0    212.0    181.0    121.0    419.0
    537.0    475.0    119.0    978.0    266.0    2248.0    370.0    164.0    137.0    127.0
    216.0    139.0    119.0    12.0    141.0    117.0    5068.0    68.0    21.0    17.0
    226.0    707.0    154.0    85.0    234.0    19.0    55.0    4495.0    116.0    174.0
    246.0    655.0    327.0    486.0    170.0    238.0    201.0    204.0    3019.0    305.0
    188.0    399.0    152.0    290.0    1191.0    135.0    222.0    564.0    210.0    2598.0
true positive rate about train set:  0.6963833333333334

error rate about train set:  0.30361666666666665


about test set confusion matrix

    858.0    14.0    5.0    17.0    7.0    22.0    28.0    24.0    4.0    1.0
    0.0    1084.0    14.0    7.0    9.0    0.0    10.0    4.0    3.0    4.0
    21.0    109.0    676.0    29.0    36.0    4.0    46.0    59.0    47.0    5.0
    29.0    39.0    22.0    770.0    10.0    36.0    26.0    35.0    26.0    17.0
    5.0    50.0    17.0    24.0    712.0    11.0    42.0    29.0    18.0    74.0
    92.0    65.0    18.0    170.0    26.0    377.0    64.0    32.0    20.0    28.0
    35.0    15.0    22.0    1.0    25.0    18.0    834.0    7.0    1.0    0.0
    24.0    119.0    31.0    14.0    21.0    3.0    8.0    743.0    32.0    33.0
    46.0    82.0    43.0    69.0    28.0    39.0    55.0    26.0    533.0    53.0
    28.0    51.0    18.0    41.0    189.0    35.0    38.0    78.0    46.0    485.0
true positive rate test set:  0.7072

error rate about train set:  0.29279999999999995



---------------------------------------
when p= 64

about train set confusion matrix

    5502.0    7.0    27.0    32.0    47.0    66.0    142.0    25.0    61.0    14.0
    1.0    6493.0    43.0    17.0    7.0    33.0    28.0    21.0    94.0    5.0
    115.0    450.0    4316.0    179.0    176.0    21.0    286.0    174.0    210.0    31.0
    87.0    215.0    247.0    4771.0    48.0    184.0    105.0    181.0    164.0    129.0
    21.0    173.0    101.0    27.0    4794.0    22.0    148.0    134.0    70.0    352.0
    416.0    197.0    67.0    698.0    186.0    3092.0    247.0    132.0    251.0    135.0
    208.0    135.0    72.0    3.0    92.0    83.0    5265.0    19.0    35.0    6.0
    57.0    298.0    82.0    59.0    127.0    14.0    30.0    5400.0    15.0    183.0
    97.0    641.0    112.0    426.0    111.0    162.0    98.0    94.0    3995.0    115.0
    77.0    108.0    48.0    102.0    509.0    53.0    47.0    807.0    49.0    4149.0
true positive rate about train set:  0.7962833333333333

error rate about train set:  0.20371666666666666


about test set confusion matrix

    925.0    1.0    1.0    5.0    3.0    13.0    23.0    3.0    6.0    0.0
    0.0    1093.0    8.0    2.0    1.0    1.0    7.0    1.0    22.0    0.0
    25.0    101.0    738.0    32.0    20.0    1.0    32.0    26.0    52.0    5.0
    14.0    29.0    25.0    819.0    6.0    26.0    13.0    32.0    28.0    18.0
    5.0    36.0    11.0    4.0    815.0    4.0    27.0    12.0    12.0    56.0
    69.0    25.0    11.0    113.0    35.0    517.0    33.0    31.0    44.0    14.0
    42.0    17.0    13.0    0.0    24.0    17.0    839.0    3.0    3.0    0.0
    7.0    58.0    24.0    7.0    14.0    2.0    7.0    883.0    1.0    25.0
    15.0    74.0    21.0    66.0    17.0    26.0    22.0    24.0    691.0    18.0
    18.0    17.0    8.0    17.0    103.0    4.0    4.0    105.0    10.0    723.0
true positive rate test set:  0.8043

error rate about train set:  0.19569999999999999



---------------------------------------
when p= 128

about train set confusion matrix

    5639.0    7.0    34.0    22.0    16.0    47.0    77.0    14.0    62.0    5.0
    1.0    6563.0    42.0    15.0    15.0    31.0    8.0    15.0    45.0    7.0
    107.0    305.0    4653.0    132.0    124.0    26.0    191.0    172.0    207.0    41.0
    56.0    193.0    201.0    5016.0    26.0    148.0    69.0    148.0    126.0    148.0
    11.0    105.0    46.0    5.0    5097.0    36.0    100.0    55.0    71.0    316.0
    202.0    184.0    60.0    551.0    122.0    3611.0    211.0    98.0    238.0    144.0
    105.0    129.0    53.0    5.0    77.0    67.0    5438.0    2.0    40.0    2.0
    56.0    220.0    53.0    55.0    164.0    6.0    11.0    5498.0    16.0    186.0
    71.0    543.0    77.0    282.0    99.0    170.0    72.0    58.0    4316.0    163.0
    81.0    105.0    28.0    121.0    456.0    41.0    19.0    536.0    39.0    4523.0
true positive rate about train set:  0.8392333333333334

error rate about train set:  0.1607666666666666


about test set confusion matrix

    943.0    1.0    2.0    2.0    1.0    7.0    15.0    1.0    7.0    1.0
    0.0    1106.0    3.0    2.0    2.0    2.0    5.0    1.0    14.0    0.0
    25.0    65.0    800.0    22.0    18.0    3.0    19.0    34.0    38.0    8.0
    7.0    20.0    26.0    854.0    5.0    20.0    9.0    35.0    22.0    12.0
    0.0    15.0    5.0    4.0    855.0    1.0    23.0    4.0    14.0    61.0
    20.0    21.0    10.0    91.0    29.0    591.0    32.0    32.0    45.0    21.0
    16.0    12.0    7.0    0.0    15.0    12.0    886.0    1.0    9.0    0.0
    4.0    46.0    19.0    6.0    22.0    1.0    1.0    893.0    0.0    36.0
    12.0    45.0    8.0    38.0    26.0    27.0    25.0    18.0    754.0    21.0
    22.0    17.0    7.0    15.0    77.0    9.0    4.0    71.0    6.0    781.0
true positive rate test set:  0.8463

error rate about train set:  0.15369999999999995



---------------------------------------
when p= 256

about train set confusion matrix

    5653.0    8.0    21.0    19.0    25.0    49.0    74.0    5.0    63.0    6.0
    1.0    6557.0    35.0    13.0    16.0    26.0    12.0    14.0    62.0    6.0
    92.0    282.0    4746.0    133.0    124.0    20.0    224.0    131.0    180.0    26.0
    44.0    164.0    175.0    5118.0    29.0    122.0    74.0    138.0    137.0    130.0
    9.0    111.0    52.0    7.0    5164.0    52.0    55.0    30.0    62.0    300.0
    185.0    108.0    27.0    496.0    126.0    3836.0    199.0    57.0    244.0    143.0
    96.0    79.0    55.0    1.0    67.0    107.0    5477.0    4.0    30.0    2.0
    55.0    230.0    43.0    45.0    163.0    7.0    7.0    5436.0    19.0    260.0
    68.0    507.0    66.0    234.0    109.0    201.0    77.0    32.0    4379.0    178.0
    72.0    83.0    31.0    115.0    362.0    18.0    7.0    460.0    43.0    4758.0
true positive rate about train set:  0.8520666666666666

error rate about train set:  0.14793333333333336


about test set confusion matrix

    940.0    1.0    1.0    2.0    2.0    11.0    15.0    1.0    6.0    1.0
    0.0    1101.0    3.0    2.0    4.0    2.0    6.0    0.0    17.0    0.0
    18.0    62.0    819.0    25.0    12.0    1.0    25.0    26.0    37.0    7.0
    5.0    18.0    24.0    879.0    4.0    15.0    9.0    23.0    24.0    9.0
    0.0    22.0    5.0    0.0    875.0    4.0    13.0    2.0    14.0    47.0
    25.0    18.0    5.0    83.0    23.0    628.0    28.0    19.0    43.0    20.0
    16.0    9.0    7.0    0.0    21.0    19.0    878.0    1.0    7.0    0.0
    5.0    46.0    18.0    6.0    24.0    0.0    3.0    881.0    0.0    45.0
    13.0    52.0    10.0    30.0    26.0    33.0    18.0    15.0    758.0    19.0
    17.0    12.0    3.0    12.0    69.0    3.0    2.0    63.0    6.0    822.0
true positive rate test set:  0.8581

error rate about train set:  0.14190000000000003



---------------------------------------
when p= 512

about train set confusion matrix

    5673.0    8.0    18.0    16.0    25.0    46.0    65.0    3.0    62.0    7.0
    2.0    6541.0    39.0    18.0    22.0    32.0    13.0    14.0    55.0    6.0
    96.0    259.0    4777.0    146.0    111.0    18.0    238.0    97.0    194.0    22.0
    42.0    169.0    177.0    5159.0    32.0    120.0    52.0    117.0    139.0    124.0
    12.0    104.0    38.0    8.0    5204.0    50.0    41.0    22.0    59.0    304.0
    171.0    96.0    29.0    437.0    114.0    3968.0    188.0    41.0    232.0    145.0
    113.0    74.0    62.0    1.0    62.0    94.0    5473.0    0.0    37.0    2.0
    55.0    194.0    37.0    49.0    160.0    7.0    5.0    5437.0    13.0    308.0
    73.0    502.0    65.0    229.0    104.0    221.0    57.0    20.0    4404.0    176.0
    67.0    63.0    22.0    115.0    371.0    13.0    3.0    493.0    39.0    4763.0
true positive rate about train set:  0.85665

error rate about train set:  0.14334999999999998


about test set confusion matrix

    946.0    0.0    1.0    2.0    2.0    8.0    11.0    2.0    7.0    1.0
    0.0    1106.0    2.0    2.0    3.0    1.0    5.0    1.0    15.0    0.0
    21.0    59.0    809.0    24.0    16.0    0.0    38.0    20.0    39.0    6.0
    4.0    17.0    22.0    884.0    6.0    15.0    10.0    23.0    19.0    10.0
    0.0    21.0    6.0    0.0    882.0    4.0    9.0    2.0    12.0    46.0
    25.0    18.0    4.0    79.0    23.0    650.0    23.0    13.0    39.0    18.0
    20.0    10.0    10.0    0.0    23.0    17.0    872.0    0.0    6.0    0.0
    5.0    41.0    15.0    7.0    25.0    0.0    1.0    885.0    0.0    49.0
    13.0    45.0    10.0    30.0    28.0    40.0    17.0    12.0    760.0    19.0
    15.0    12.0    2.0    16.0    79.0    0.0    2.0    78.0    4.0    801.0
true positive rate test set:  0.8595

error rate about train set:  0.14049999999999996



---------------------------------------
when p= 1024

about train set confusion matrix

    5682.0    7.0    18.0    14.0    24.0    43.0    64.0    4.0    61.0    6.0
    2.0    6548.0    40.0    15.0    19.0    31.0    14.0    12.0    55.0    6.0
    99.0    264.0    4792.0    149.0    108.0    11.0    234.0    91.0    192.0    18.0
    42.0    167.0    176.0    5159.0    32.0    124.0    56.0    115.0    135.0    125.0
    10.0    99.0    42.0    6.0    5211.0    50.0    39.0    23.0    59.0    303.0
    164.0    95.0    28.0    433.0    105.0    3990.0    192.0    36.0    235.0    143.0
    108.0    74.0    61.0    1.0    70.0    90.0    5476.0    0.0    35.0    3.0
    55.0    189.0    37.0    47.0    170.0    9.0    2.0    5426.0    10.0    320.0
    75.0    493.0    63.0    226.0    105.0    222.0    56.0    20.0    4411.0    180.0
    68.0    60.0    20.0    117.0    371.0    12.0    4.0    491.0    38.0    4768.0
true positive rate about train set:  0.8577166666666667

error rate about train set:  0.14228333333333332


about test set confusion matrix

    944.0    0.0    1.0    2.0    2.0    7.0    14.0    2.0    7.0    1.0
    0.0    1107.0    2.0    2.0    3.0    1.0    5.0    1.0    14.0    0.0
    18.0    54.0    813.0    26.0    15.0    0.0    42.0    22.0    37.0    5.0
    4.0    18.0    23.0    879.0    5.0    17.0    9.0    21.0    22.0    12.0
    0.0    22.0    6.0    1.0    881.0    5.0    10.0    2.0    11.0    44.0
    23.0    18.0    3.0    72.0    24.0    659.0    23.0    14.0    39.0    17.0
    18.0    10.0    9.0    0.0    22.0    17.0    875.0    0.0    7.0    0.0
    5.0    40.0    16.0    6.0    26.0    0.0    1.0    884.0    0.0    50.0
    14.0    46.0    11.0    30.0    27.0    40.0    15.0    12.0    759.0    20.0
    15.0    11.0    2.0    17.0    80.0    1.0    1.0    77.0    4.0    801.0
true positive rate test set:  0.8602

error rate about train set:  0.13980000000000004

    \end{Verbatim}

    compared without one vector and with one vector, true positive rate
about both train and test set is improved!

\begin{figure}
\centering
\includegraphics{./image.PNG}
\caption{image}
\end{figure}


    % Add a bibliography block to the postdoc
    
    
    
    \end{document}
